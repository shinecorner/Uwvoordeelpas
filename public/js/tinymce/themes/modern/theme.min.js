tinymce.ThemeManager.add("modern",function(e){function t(t,n){var i,o=[];return t?(f(t.split(/[ ,]/),function(t){function r(){var n=e.selection;"bullist"==l&&n.selectorChanged("ul > li",function(e,n){for(var i,o=n.parents.length;o--&&(i=n.parents[o].nodeName,"OL"!=i&&"UL"!=i););t.active(e&&"UL"==i)}),"numlist"==l&&n.selectorChanged("ol > li",function(e,n){for(var i,o=n.parents.length;o--&&(i=n.parents[o].nodeName,"OL"!=i&&"UL"!=i););t.active(e&&"OL"==i)}),t.settings.stateSelector&&n.selectorChanged(t.settings.stateSelector,function(e){t.active(e)},!0),t.settings.disabledStateSelector&&n.selectorChanged(t.settings.disabledStateSelector,function(e){t.disabled(e)})}var l;"|"==t?i=null:m.has(t)?(t={type:t,size:n},o.push(t),i=null):(i||(i={type:"buttongroup",items:[]},o.push(i)),e.buttons[t]&&(l=t,t=e.buttons[l],"function"==typeof t&&(t=t()),t.type=t.type||"button",t.size=n,t=m.create(t),i.items.push(t),e.initialized?r():e.on("init",r)))}),{type:"toolbar",layout:"flow",items:o}):void 0}function n(e){function n(n){return n?(i.push(t(n,e)),!0):void 0}var i=[];if(tinymce.isArray(d.toolbar)){if(0===d.toolbar.length)return;tinymce.each(d.toolbar,function(e,t){d["toolbar"+(t+1)]=e}),delete d.toolbar}for(var o=1;10>o&&n(d["toolbar"+o]);o++);return i.length||d.toolbar===!1||n(d.toolbar||g),i.length?{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:i}:void 0}function i(){function t(t){var n;return"|"==t?{text:"|"}:n=e.menuItems[t]}function n(n){var i,o,r,l,a;if(a=tinymce.makeMap((d.removed_menuitems||"").split(/[ ,]/)),d.menu?(o=d.menu[n],l=!0):o=p[n],o){i={text:o.title},r=[],f((o.items||"").split(/[ ,]/),function(e){var n=t(e);n&&!a[e]&&r.push(t(e))}),l||f(e.menuItems,function(e){e.context==n&&("before"==e.separator&&r.push({text:"|"}),e.prependToContext?r.unshift(e):r.push(e),"after"==e.separator&&r.push({text:"|"}))});for(var s=0;s<r.length;s++)"|"==r[s].text&&(0===s||s==r.length-1)&&r.splice(s,1);if(i.menu=r,!i.menu.length)return null}return i}var i,o=[],r=[];if(d.menu)for(i in d.menu)r.push(i);else for(i in p)r.push(i);for(var l="string"==typeof d.menubar?d.menubar.split(/[ ,]/):r,a=0;a<l.length;a++){var s=l[a];s=n(s),s&&o.push(s)}return o}function o(t){function n(e){var n=t.find(e)[0];n&&n.focus(!0)}e.shortcuts.add("Alt+F9","",function(){n("menubar")}),e.shortcuts.add("Alt+F10","",function(){n("toolbar")}),e.shortcuts.add("Alt+F11","",function(){n("elementpath")}),t.on("cancel",function(){e.focus()})}function r(t,n){function i(e){return{width:e.clientWidth,height:e.clientHeight}}var o,r,l,a;o=e.getContainer(),r=e.getContentAreaContainer().firstChild,l=i(o),a=i(r),null!==t&&(t=Math.max(d.min_width||100,t),t=Math.min(d.max_width||65535,t),h.setStyle(o,"width",t+(l.width-a.width)),h.setStyle(r,"width",t)),n=Math.max(d.min_height||100,n),n=Math.min(d.max_height||65535,n),h.setStyle(r,"height",n),e.fire("ResizeEditor")}function l(t,n){var i=e.getContentAreaContainer();u.resizeTo(i.clientWidth+t,i.clientHeight+n)}function a(){function n(){return e.contextToolbars||[]}function i(t){var n,i,o;return n=tinymce.DOM.getPos(e.getContentAreaContainer()),i=e.dom.getRect(t),o=e.dom.getRoot(),"BODY"==o.nodeName&&(i.x-=o.ownerDocument.documentElement.scrollLeft||o.scrollLeft,i.y-=o.ownerDocument.documentElement.scrollTop||o.scrollTop),i.x+=n.x,i.y+=n.y,i}function o(){f(e.contextToolbars,function(e){e.panel&&e.panel.hide()})}function r(t){var n,r,l,a,s,c,u;if(!e.removed){if(!t||!t.toolbar.panel)return void o();u=["tc-bc","bc-tc","tl-bl","bl-tl","tr-br","br-tr"],s=t.toolbar.panel,s.show(),l=i(t.element),r=tinymce.DOM.getRect(s.getEl()),a=tinymce.DOM.getRect(e.getContentAreaContainer()||e.getBody()),e.inline||(a.w=e.getDoc().documentElement.offsetWidth),e.selection.controlSelection.isResizable(t.element)&&(l=b.inflate(l,0,7)),n=b.findBestRelativePosition(r,l,a,u),n?(f(u.concat("inside"),function(e){s.classes.toggle("tinymce-inline-"+e,e==n)}),c=b.relativePosition(r,l,n),s.moveTo(c.x,c.y)):(f(u,function(e){s.classes.toggle("tinymce-inline-"+e,!1)}),s.classes.toggle("tinymce-inline-inside",!0),l=b.intersect(a,l),l?(n=b.findBestRelativePosition(r,l,a,["tc-tc","tl-tl","tr-tr"]),n?(c=b.relativePosition(r,l,n),s.moveTo(c.x,c.y)):s.moveTo(l.x,l.y)):s.hide())}}function l(){function t(){e.selection&&r(u(e.selection.getNode()))}window.requestAnimationFrame?window.requestAnimationFrame(t):t()}function a(){d||(d=e.selection.getScrollContainer()||e.getWin(),tinymce.$(d).on("scroll",l),e.on("remove",function(){tinymce.$(d).off("scroll")}))}function s(e){var n;return e.toolbar.panel?(e.toolbar.panel.show(),void r(e)):(a(),n=m.create({type:"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:t(e.toolbar.items)}),e.toolbar.panel=n,n.renderTo(document.body).reflow(),void r(e))}function c(){tinymce.each(n(),function(e){e.panel&&e.panel.hide()})}function u(t){var i,o,r,l=n();for(r=e.$(t).parents().add(t),i=r.length-1;i>=0;i--)for(o=l.length-1;o>=0;o--)if(l[o].predicate(r[i]))return{toolbar:l[o],element:r[i]};return null}var d;e.on("click keyup blur",function(){window.setTimeout(function(){var t;e.removed||(t=u(e.selection.getNode()),t?s(t):c())},0)}),e.on("ObjectResizeStart",function(){var t=u(e.selection.getNode());t&&t.toolbar.panel&&t.toolbar.panel.hide()}),e.on("nodeChange ResizeEditor ResizeWindow",l),e.on("remove",function(){tinymce.each(n(),function(e){e.panel&&e.panel.remove()}),e.contextToolbars={}})}function s(t){function r(){if(f&&f.moveRel&&f.visible()&&!f._fixed){var t=e.selection.getScrollContainer(),n=e.getBody(),i=0,o=0;if(t){var r=h.getPos(n),l=h.getPos(t);i=Math.max(0,l.x-r.x),o=Math.max(0,l.y-r.y)}f.fixed(!1).moveRel(n,e.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(i,o)}}function l(){f&&(f.show(),r(),h.addClass(e.getBody(),"mce-edit-focus"))}function s(){f&&(f.hide(),y.hideAll(),h.removeClass(e.getBody(),"mce-edit-focus"))}function c(){return f?void(f.visible()||l()):(f=u.panel=m.create({type:b?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!b,border:1,items:[d.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:i()},n(d.toolbar_items_size)]}),e.fire("BeforeRenderUI"),f.renderTo(b||document.body).reflow(),o(f),l(),a(),e.on("nodeChange",r),e.on("activate",l),e.on("deactivate",s),void e.nodeChanged())}var f,b;return d.fixed_toolbar_container&&(b=h.select(d.fixed_toolbar_container)[0]),d.content_editable=!0,e.on("focus",function(){t.skinUiCss?tinymce.DOM.styleSheetLoader.load(t.skinUiCss,c,c):c()}),e.on("blur hide",s),e.on("remove",function(){f&&(f.remove(),f=null)}),t.skinUiCss&&tinymce.DOM.styleSheetLoader.load(t.skinUiCss),{}}function c(t){var l,s,c;return t.skinUiCss&&tinymce.DOM.loadCSS(t.skinUiCss),l=u.panel=m.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[d.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:i()},n(d.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]}),d.resize!==!1&&(s={type:"resizehandle",direction:d.resize,onResizeStart:function(){var t=e.getContentAreaContainer().firstChild;c={width:t.clientWidth,height:t.clientHeight}},onResize:function(e){"both"==d.resize?r(c.width+e.deltaX,c.height+e.deltaY):r(null,c.height+e.deltaY)}}),d.statusbar!==!1&&l.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath"},s]}),d.readonly&&l.find("*").disabled(!0),e.fire("BeforeRenderUI"),l.renderBefore(t.targetNode).reflow(),d.width&&tinymce.DOM.setStyle(l.getEl(),"width",d.width),e.on("remove",function(){l.remove(),l=null}),o(l),a(),{iframeContainer:l.find("#iframe")[0].getEl(),editorContainer:l.getEl()}}var u=this,d=e.settings,m=tinymce.ui.Factory,f=tinymce.each,h=tinymce.DOM,b=tinymce.ui.Rect,y=tinymce.ui.FloatPanel,p={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},g="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";u.renderUI=function(t){var n=d.skin!==!1?d.skin||"lightgray":!1;if(n){var i=d.skin_url;i=i?e.documentBaseURI.toAbsolute(i):tinymce.baseURL+"/skins/"+n,tinymce.Env.documentMode<=7?t.skinUiCss=i+"/skin.ie7.min.css":t.skinUiCss=i+"/skin.min.css",e.contentCSS.push(i+"/content"+(e.inline?".inline":"")+".min.css")}return e.on("ProgressState",function(e){u.throbber=u.throbber||new tinymce.ui.Throbber(u.panel.getEl("body")),e.state?u.throbber.show(e.time):u.throbber.hide()}),d.inline?s(t):c(t)},u.resizeTo=r,u.resizeBy=l});